---
path: /sdk/features/evaluation-reasons
title: Flag evaluation reasons
description: This topic explains how to use the flag evaluation reason feature to get more information about the flag variations LaunchDarkly serves to contexts or users.
published: true
tags: ['flag', 'evaluation', 'reason', 'sdk', 'variationdetail', 'boolvariationdetail', 'stringvariationdetail', 'jsonvariationdetail']
---

## Overview

This topic explains how to use the flag evaluation reason feature to get more information about the flag variations LaunchDarkly serves to contexts or users.

To learn more about how LaunchDarkly determines why a context or user receives a given flag variation, read [Evaluation reasons](/sdk/concepts/evaluation-reasons).

<Callout intent="info">
<CalloutTitle>Newer versions of LaunchDarkly SDKs replace users with contexts</CalloutTitle>
<CalloutDescription>

A context is a generalized way of referring to the people, services, machines, or other resources that encounter feature flags in your product. To learn more, read [Contexts](/home/contexts).

Creating contexts and evaluating flags based on them is supported in the latest major versions of [some of our SDKs](/sdk). For these SDKs, the code samples on this page include the two most recent versions.

You can upgrade your SDKs at any time, but the ability to target by context, or review context instances that have encountered flags in your application, is only available for customers in the contexts Early Access Program (EAP). If you want access to this feature, [join the EAP](https://launchdarkly.com/eap).

If you are using the latest version of an SDK and are not part of the EAP, your application can send contexts to LaunchDarkly and they will appear on the **Users** list.

</CalloutDescription>
</Callout>

## Understanding the flag evaluation reason feature

Details about each SDK's configuration are available in the SDK-specific sections below.

* [Client-side SDKs](#client-side-sdks)
* [Server-side SDKs](#server-side-sdks)

## Client-side SDKs

<Callout intent="alert">
<CalloutTitle>An evaluation reason configuration option is required</CalloutTitle>
<CalloutDescription>

In client-side SDKs, you must enable an evaluation reason configuration option for this feature to work. The code samples below include this option. To learn more about configuration options, read [Configuration](/sdk/features/config).

</CalloutDescription>
</Callout>

This feature is available in the following client-side SDKs:

* [.NET (client-side)](#net-client-side)
* [Android](#android)
* [C/C++ (client-side)](#cc-client-side)
* [Flutter](#flutter)
* [iOS](#ios)
* [JavaScript](#javascript)
* [Node.js (client-side)](#nodejs-client-side)
* [React Native](#react-native)
* [Roku](#roku)

### .NET (client-side)

<Details summary="Expand .NET (client-side) code sample">

The `VariationDetail` methods, such as `BoolVariationDetail`, work the same as `Variation`, but also provide additional "reason" information about how a flag value was calculated. For example, you can find out if the context was individually targeted for the flag or was matched by one of the flag's rules. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label=".NET SDK v3.0 (C#)">

```csharp

Configuration config = Configuration
    .Builder("mobile-key-123abc")
    .EvaluationReasons(true)
    .Build();
LdClient client = LdClient.Init(config, context);

EvaluationDetail<bool> detail =
    client.BoolVariationDetail("bool-flag-key-123abc", false);
    // or StringVariationDetail for a string-valued flag, and so on.

bool value = detail.Value;
int? index = detail.VariationIndex;
EvaluationReason reason = detail.Reason;
```

</CSTab>
<CSTab label=".NET SDK v2.x (C#)">

```csharp

Configuration config = Configuration
    .Builder("mobile-key-123abc")
    .EvaluationReasons(true)
    .Build();
LdClient client = LdClient.Init(config, user);

EvaluationDetail<bool> detail =
    client.BoolVariationDetail("bool-flag-key-123abc", false);
    // or StringVariationDetail for a string-valued flag, and so on.

bool value = detail.Value;
int? index = detail.VariationIndex;
EvaluationReason reason = detail.Reason;
```

</CSTab>
</CodeSample>

To learn more about the `VariationDetail` methods, read [`EvaluationDetail`](https://launchdarkly.github.io/dotnet-client-sdk/api/LaunchDarkly.Sdk.EvaluationDetail-1.html) and [`BoolVariationDetail`](https://launchdarkly.github.io/dotnet-client-sdk/api/LaunchDarkly.Sdk.Client.LdClient.html#LaunchDarkly_Sdk_Client_LdClient_BoolVariationDetail_). To learn more about the configuration option, read [`EvaluationReasons`](https://launchdarkly.github.io/dotnet-client-sdk/api/LaunchDarkly.Sdk.Client.ConfigurationBuilder.html#LaunchDarkly_Sdk_Client_ConfigurationBuilder_EvaluationReasons_System_Boolean_).
</Details>

### Android

<Details summary="Expand Android code sample">

The `variationDetail` methods, such as `boolVariationDetail`, work the same as `variation`. They also provide additional "reason" information about how a flag value was calculated, such as if the context matched a specific rule. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="Android SDK v4.0 (Java)">

```java
LDConfig ldConfig = new LDConfig.Builder()
  .mobileKey("mobile-key-123abc")
  .evaluationReasons(true)
  .build();
LDClient client = LDClient.init(this.getApplication(), ldConfig, context, secondsToBlock);

EvaluationDetail<Boolean> detail =
  client.boolVariationDetail("flag-key", false);
  // or stringVariationDetail for a string-valued flag, etc.

boolean value = detail.getValue();
Integer index = detail.getVariationIndex();
EvaluationReason reason = detail.getReason();
```

</CSTab>
<CSTab label="Android SDK v3.x (Java)">

```java
LDConfig ldConfig = new LDConfig.Builder()
  .mobileKey("YOUR_MOBILE_KEY")
  .evaluationReasons(true)
  .build();
LDClient client = LDClient.init(this.getApplication(), ldConfig, user, secondsToBlock);

EvaluationDetail<Boolean> detail =
  client.boolVariationDetail("flag-key", false);
  // or stringVariationDetail for a string-valued flag, and so on.

boolean value = detail.getValue();
Integer index = detail.getVariationIndex();
EvaluationReason reason = detail.getReason();
```

</CSTab>
</CodeSample>

To learn more about the `variationDetail` methods, read [`EvaluationDetail`](https://launchdarkly.github.io/android-client-sdk/com/launchdarkly/sdk/EvaluationDetail.html) and [`getVariationIndex`](https://launchdarkly.github.io/android-client-sdk/com/launchdarkly/sdk/EvaluationDetail.html#getVariationIndex--). To learn more about the configuration option, read [`evaluationReasons`](https://launchdarkly.github.io/android-client-sdk/com/launchdarkly/sdk/android/LDConfig.Builder.html#evaluationReasons(boolean)).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="Java">

```java
void printReason(EvaluationReason reason) {
  switch (reason.getKind()) {
    case OFF:
      Timber.d("it's off");
      break;
    case FALLTHROUGH:
      Timber.d("fell through");
      break;
    case TARGET_MATCH:
      Timber.d("targeted");
      break;
    case RULE_MATCH:
      EvaluationReason.RuleMatch rm =
        (EvaluationReason.RuleMatch)reason;
      Timber.d("matched rule %d/%s",
               rm.getRuleIndex(),
               rm.getRuleId());
      break;
    case PREREQUISITE_FAILED:
      EvaluationReason.PrerequisiteFailed pf =
        (EvaluationReason.PrerequisiteFailed)reason;
      Timber.d("prereq failed: %s", pf.getPrerequisiteKey());
      break;
    case ERROR:
      EvaluationReason.Error e = (EvaluationReason.Error)reason;
      Timber.d("error: %s", e.getErrorKind());
  }
  // or, if all you want is a simple descriptive string:
  Timber.d(reason.toString());
}
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationReason`](https://javadoc.io/static/com.launchdarkly/launchdarkly-android-client-sdk/2.12.0/com/launchdarkly/android/EvaluationReason.html).

</Details>

### C/C++ (client-side)

<Details summary="Expand C/C++ (client-side) code sample">

By passing an `LDVariationDetails` struct to a variation call you can programmatically inspect the reason for a particular evaluation.

The `details.reason` member is the `reason` object described in [Evaluation reasons](/sdk/concepts/evaluation-reasons).

Here is an example:

<CodeSample>
<CSTab label="C">

```c
struct LDConfig *config = LDConfigNew("mobile-key-123abc");
LDConfigSetUseEvaluationReasons(config, LDBooleanTrue);
struct LDClient *client = LDClientInit(config, user, maxwaitmilliseconds);

LDVariationDetails details;
LDBoolean value;

value = LDBoolVariationDetail(client, "your.feature.key", LDBooleanFalse, &details);

/* inspect details.reason, which is a JSON object */
if (strcmp(LDGetText(LDObjectLookup(details->reason, "errorKind")), "FLAG_NOT_FOUND") == 0) {
    /* ... */
}

LDFreeDetailContents(&details);
```

</CSTab>
<CSTab label="C++">

```cpp
struct LDConfig *config = LDConfigNew("mobile-key-123abc");
LDConfigSetUseEvaluationReasons(config, LDBooleanTrue);
LDClientCPP *client = LDClientCPP::Init(config, user, maxwaitmilliseconds);

LDVariationDetails details;

bool value = client->boolVariationDetail("your.feature.key", false, &details);

/* inspect details.reason, which is a JSON object */
if (strcmp(LDGetText(LDObjectLookup(details->reason, "errorKind")), "FLAG_NOT_FOUND") == 0) {
/* ... */
}

LDFreeDetailContents(&details);
```

</CSTab>
</CodeSample>

To learn more about the `LDVariationDetails` structure, inspect [`client.h`](https://launchdarkly.github.io/c-client-sdk/structLDVariationDetails.html). To learn more about the configuration option, inspect [`config.h`](https://launchdarkly.github.io/c-client-sdk/config_8h.html).
</Details>

### Flutter

<Details summary="Expand Flutter code sample">

The `variationDetail` methods, such as `boolVariationDetail`, work the same as `variation`. They also provide additional "reason" information about how a flag value was calculated, such as if the user matched a specific rule. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="Dart">

```dart
final LDConfig config = LDConfigBuilder("mobile-key-123abc")
  .evaluationReasons(true)
  .build();
await LDClient.start(config, user);

LDEvaluationDetail<bool> detail =
  await LDClient.boolVariationDetail("flag-key", false);
  // or stringVariationDetail for a string-valued flag, and so on.

bool value = detail.value;
int index = detail.variationIndex;
LDEvaluationReason reason = detail.reason;
```

</CSTab>
</CodeSample>

To learn more about the `variationDetail` methods, read [`LDEvaluationDetail`](https://launchdarkly.github.io/flutter-client-sdk/launchdarkly_flutter_client_sdk/LDEvaluationDetail-class.html) and [`boolVariationDetail`](https://launchdarkly.github.io/flutter-client-sdk/launchdarkly_flutter_client_sdk/LDClient/boolVariationDetail.html). To learn more about the configuration option, read [`evaluationReasons`](https://launchdarkly.github.io/flutter-client-sdk/launchdarkly_flutter_client_sdk/LDConfigBuilder/evaluationReasons.html).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="Dart">

```dart
void printReason(LDEvaluationReason reason) {
  switch (reason.kind) {
    case LDKind.OFF:
      print("it's off");
      break;
    case LDKind.FALLTHROUGH:
      print('fell through');
      break;
    case LDKind.TARGET_MATCH:
      print('targeted');
      break;
    case LDKind.RULE_MATCH:
      print('matched rule: ${reason.ruleIndex} ${reason.ruleId}');
      break;
    case LDKind.PREREQUISITE_FAILED:
      print('prereq failed: ${reason.prerequisiteKey}');
      break;
    case LDKind.ERROR:
      print('error: ${reason.errorKind}');
      break;
    default: // LDKind.UNKNOWN
      print('unknown service kind');
  }
}
```

</CSTab>
</CodeSample>

To learn more, read [`LDEvaluationReason`](https://launchdarkly.github.io/flutter-client-sdk/launchdarkly_flutter_client_sdk/LDEvaluationDetail-class.html).

</Details>

### iOS

<Details summary="Expand iOS code sample">

The `variationDetail` methods, such as `boolVariationDetail`, work the same as the variation methods. They also provide additional "reason" information about how a flag value was calculated, such as if the user matched a specific rule. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="iOS SDK v8.0 (Swift)">

```swift
ldConfig.evaluationReasons = true
LDClient.start(config: ldConfig, context: context)

let detail = client.boolVariationDetail(forKey: "flag-key", defaultValue: false);

let value: Bool = detail.value
let variationIndex: Int? = detail.variationIndex
let reason: [String: LDValue]? = detail.reason
```

</CSTab>
<CSTab label="iOS SDK v8.0 (Objective-C)">

```objc
config.evaluationReasons = true;
[LDClient startWithConfiguration:config context:result.success completion: nil];

LDBoolEvaluationDetail *detail = [[LDClient get] boolVariationDetailForKey:@"flag-key" defaultValue:NO];

BOOL value = detail.value;
NSInteger variationIndex = detail.variationIndex;
NSDictionary<NSString*, LDValue*> *reason = detail.reason;
```

</CSTab>
<CSTab label="iOS SDK v7.x (Swift)">

```swift
ldConfig.evaluationReasons = true
LDClient.start(config: ldConfig, user: user)

let detail = client.boolVariationDetail(forKey: "flag-key", defaultValue: false);

let value: Bool = detail.value
let variationIndex: Int? = detail.variationIndex
let reason: [String: LDValue]? = detail.reason
```

</CSTab>
</CodeSample>

To learn more about the `variationDetail` methods, read [`LDEvaluationDetail`](https://launchdarkly.github.io/ios-client-sdk/Classes/LDEvaluationDetail.html) and [`boolVariationDetail`](https://launchdarkly.github.io/ios-client-sdk/Classes/LDClient.html#/s:12LaunchDarkly8LDClientC19boolVariationDetail6forKey12defaultValueAA012LDEvaluationF0CySbGSS_SbtF). To learn more about the configuration option, read [`LDConfig`](https://launchdarkly.github.io/ios-client-sdk/Structs/LDConfig.html).
</Details>

### JavaScript

<Details summary="Expand JavaScript code sample">

The `variationDetail` method lets you evaluate a feature flag with the same parameters you would for `variation`. With `variationDetail`, you receive more information about how the value was calculated.

The variation detail returns in an object containing both the result value and a "reason" object which tells you more information about the flag evaluation. For example, you can find out if the context was individually targeted for the flag or was matched by one of the flag's rules. It also indicates if the flag returned the default value due to an error. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="JavaScript SDK 3.0">

```js
const options = { evaluationReasons: true };
const client = LDClient.initialize('client-side-id-123abc', context, options);

const detail = client.variationDetail('flag-key-123abc', false);

const value = detail.value;
const index = detail.variationIndex;
const reason = detail.reason;
```

</CSTab>
<CSTab label="JavaScript SDK 2.x">

```js
const options = { evaluationReasons: true };
const client = LDClient.initialize('client-side-id-123abc', user, options);

const detail = client.variationDetail('flag-key-123abc', false);

const value = detail.value;
const index = detail.variationIndex;
const reason = detail.reason;
```

</CSTab>
</CodeSample>

To learn more about the `variationDetail` methods, read [`LDEvaluationDetail`](https://launchdarkly.github.io/js-client-sdk/interfaces/LDEvaluationDetail.html) and [`variationDetail`](https://launchdarkly.github.io/js-client-sdk/interfaces/LDClient.html#variationDetail). To learn more about the configuration option, read [`evaluationReasons`](https://launchdarkly.github.io/js-client-sdk/interfaces/LDOptions.html#evaluationReasons).
</Details>

### Node.js (client-side)

<Details summary="Expand Node.js (client-side) code sample">

The `variationDetail` method lets you evaluate a feature flag with the same parameters you would for `variation`. With `variationDetail`, you receive more information about how the value was calculated.

The variation detail returns in an object that contains both the result value and a "reason" object which tells you more information about the flag evaluation. For example, you can find out if the user was individually targeted for the flag or was matched by one of the flag's rules. It also indicates if the flag returned the default value due to an error. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="JavaScript">

```js
const options = { evaluationReasons: true };
const client = LDClient.initialize('client-side-id-123abc', user, options);

const detail = client.variationDetail('flag-key', false);

const value = detail.value;
const index = detail.variationIndex;
const reason = detail.reason;
```

</CSTab>
</CodeSample>

To learn more about the `variationDetail` method, read [`LDEvaluationDetail`](https://launchdarkly.github.io/node-client-sdk/interfaces/LDEvaluationDetail.html) and [`variationDetail`](https://launchdarkly.github.io/node-client-sdk/interfaces/LDClient.html#variationDetail). To learn more about the configuration option, read [`evaluationReasons`](https://launchdarkly.github.io/node-client-sdk/interfaces/LDOptions.html#evaluationReasons).
</Details>

### React Native

<Details summary="Expand React Native code sample">

The `variationDetail` methods work the same as `variation`, but also provide additional `reason` information about how a flag value was calculated. For example, you can find out if the user was individually targeted for the flag or was matched by one of the flag's rules. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="JavaScript">

```js
let config = {
  mobileKey: 'mobile-key-123abc',
  evaluationReasons: true
};
await client.configure(config, user);

const detail =
  client.boolVariationDetail('flag-key-123abc', false);

const value = detail.value;
const index = detail.variationIndex;
const reason = detail.reason;
```

</CSTab>
</CodeSample>

To learn more about the `variationDetail` methods, read [`LDEvaluationDetail`](https://launchdarkly.github.io/react-native-client-sdk/index.html#LDEvaluationDetail) and [`boolVariationDetail`](https://launchdarkly.github.io/react-native-client-sdk/classes/LDClient.html#boolVariationDetail). To learn more about the configuration option, read [`LDConfig`](https://launchdarkly.github.io/react-native-client-sdk/index.html#LDConfig).
</Details>

### Roku

<Details summary="Expand Roku code sample">

For each variation type there is also an associated version that returns the reason a particular value was returned.

Here is an example:

<CodeSample>
<CSTab label="BrightScript">

```brightscript
config.setUseEvaluationReasons(true)

details = launchDarkly.intVariationDetail("flag-key-123abc", 123)

```

</CSTab>
</CodeSample>

These variation methods return an object containing the keys `value`, `reason`, and `variationIndex`. The `value` field is the result of the evaluation. The `reason` field is an object that explains why the result happened, for example details about a rule match. The reason object will always contain a `kind` field. Lastly the `variationIndex` field contains the ID of the particular value returned. This field may be null.
</Details>

## Server-side SDKs

Unlike client-side SDKs, you do not need to enable an evaluation reason configuration option in server-side SDKs for this feature to work.

This feature is available in the following server-side SDKs:

* [.NET (server-side)](#net-server-side)
* [Apex](#apex)
* [C/C++ (server-side)](#cc-server-side)
* [Erlang](#erlang)
* [Go](#go)
* [Haskell](#haskell)
* [Java](#java)
* [Lua](#lua)
* [Node.js (server-side)](#nodejs-server-side)
* [Node.js (Cloudflare)](#nodejs-cloudflare)
* [PHP](#php)
* [Python](#python)
* [Ruby](#ruby)
* [Rust](#rust)

### .NET (server-side)

<Details summary="Expand .NET (server-side) code sample">

The `VariationDetail` methods, such as [`BoolVariationDetail`](https://launchdarkly.github.io/dotnet-server-sdk/api/LaunchDarkly.Sdk.Server.LdClient.html#LaunchDarkly_Sdk_Server_LdClient_BoolVariationDetail_), work the same as the `Variation` methods, but also provide additional "reason" information about how a flag value was calculated. For example, you can find out if the context was individually targeted for the flag or was matched by one of the flag's rules. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label=".NET SDK v7.0 (C#)">

```csharp
EvaluationDetail<bool> detail =
    client.BoolVariationDetail("flag-key", myContext, false);
    // or StringVariationDetail for a string-valued flag, etc.

bool value = detail.Value;
int? index = detail.VariationIndex;
EvaluationReason reason = detail.Reason;
```

</CSTab>
<CSTab label=".NET SDK v6.x (C#)">

```csharp
EvaluationDetail<bool> detail =
    client.BoolVariationDetail("flag-key-123abc", myUser, false);
    // or StringVariationDetail for a string-valued flag, etc.

bool value = detail.Value;
int? index = detail.VariationIndex;
EvaluationReason reason = detail.Reason;
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail`](https://launchdarkly.github.io/dotnet-server-sdk/api/LaunchDarkly.Sdk.EvaluationDetail-1.html), [`BoolVariationDetail`](https://launchdarkly.github.io/dotnet-server-sdk/api/LaunchDarkly.Sdk.Server.LdClient.html#LaunchDarkly_Sdk_Server_LdClient_BoolVariationDetail_).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="C#">

```csharp
void PrintReason(EvaluationReason reason)
{
  switch (reason.Kind)
  {
    case EvaluationReasonKind.OFF:
      Console.WriteLine("it's off");
      break;
    case EvaluationReasonKind.FALLTHROUGH:
      Console.WriteLine("fell through");
      break;
    case EvaluationReasonKind.TARGET_MATCH:
      Console.WriteLine("targeted");
      break;
    case EvaluationReasonKind.RULE_MATCH:
      var rm = reason as EvaluationReason.RuleMatch;
      Console.WriteLine("matched rule " + rm.RuleIndex + "/" + rm.RuleID);
      break;
    case EvaluationReasonKind.PREREQUISITE_FAILED:
      var pf = reason as EvaluationReason.PrerequisiteFailed;
      Console.WriteLine("prereq failed: " + pf.PrerequisiteKey);
      break;
    case EvaluationReasonKind.ERROR:
      var e = reason as EvaluationReason.Error;
      Console.WriteLine("error: " + e.ErrorKind);
      break;
  }
  // or, if all you want is a simple descriptive string:
  System.out.println(reason.ToString());
}
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationReason`](https://launchdarkly.github.io/dotnet-server-sdk/api/LaunchDarkly.Sdk.EvaluationReason.html).

</Details>

### Apex

<Details summary="Expand Apex code sample">

By passing an `LDClient.EvaluationDetail` object to a variation call you can programmatically inspect the reason for a particular evaluation.

Here is an example:

<CodeSample>
<CSTab label="Apex">

```java
LDClient.EvaluationDetail details = new LDClient.EvaluationDetail();

Boolean value = client.boolVariation(user, 'your.feature.key', false, details);

/* inspect details here */
if (details.getReason().getKind() == EvaluationReason.Kind.OFF) {
    /* ... */
}
```

</CSTab>
</CodeSample>
</Details>

### C/C++ (server-side)

<Details summary="Expand C/C++ (server-side) code sample">

By passing an `LDDetails` struct to a variation call you can programmatically inspect the reason for a particular evaluation.

Here is an example:

<CodeSample>
<CSTab label="C">

```c
struct LDDetails details;
LDBoolean value;

value = LDBoolVariation(client, user, "your.feature.key", LDBooleanFalse, &details);

/* inspect details here */
if (details.reason == LD_RULE_MATCH) {
    /* ... */
}

LDDetailsClear(&details);
```

</CSTab>
<CSTab label="C++">

```cpp
LDDetails details;

bool value = LDBoolVariation(client, user, "your.feature.key", false, &details);

/* inspect details here */
if (details.reason == LD_RULE_MATCH) {
    /* ... */
}

LDDetailsClear(&details);
```

</CSTab>
</CodeSample>

To learn more about the `LDDetails` structure, inspect [`variations.h`](https://launchdarkly.github.io/c-server-sdk/structLDDetails.html).
</Details>

### Erlang

<Details summary="Expand Erlang code sample">

The `variation_detail` function is similar to the variation function, but also returns an explanation of the evaluation that you can inspect programmatically.

Here is an example:

<CodeSample>
<CSTab label="Erlang">

```
Flag = ldclient:variation_detail(<<"flag-key-123abc">>, #{key => <<"user-key-123abc">>}, false)
```

</CSTab>
</CodeSample>
</Details>

### Go

<Details summary="Expand Go code sample">

The `VariationDetail` methods, such as [`BoolVariationDetail`](https://pkg.go.dev/github.com/launchdarkly/go-server-sdk/v6#LDClient.BoolVariationDetail), work the same as `Variation`, but also provide additional "reason" information about how a flag value was calculated. For example, you can find out if the context was individually targeted for the flag or was matched by one of the flag's rules. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="Go SDK v6.0">

```go
value, detail, err := client.BoolVariationDetail("flag-key", context, false)
// or StringVariationDetail for a string-valued flag, etc.

index := detail.VariationIndex
reason := detail.Reason

```

</CSTab>
<CSTab label="Go SDK v5.x">

```go
value, detail, err := client.BoolVariationDetail("flag-key", myUser, false)
// or StringVariationDetail for a string-valued flag, and so on.

index := detail.VariationIndex
reason := detail.Reason

// In Go SDK 5.0 and higher, detail.VariationIndex uses the type ldvalue.OptionalInt, which
// allows an "undefined" state if evaluation failed. In earlier Go SDK versions, it is an
// *int which is nil if evaluation failed.
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail`](https://pkg.go.dev/github.com/launchdarkly/go-sdk-common/v3@v3.0.0/ldreason#EvaluationDetail) and [`BoolVariationDetail`](https://pkg.go.dev/github.com/launchdarkly/go-server-sdk/v6#LDClient.BoolVariationDetail).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="Go SDK v6.0">

```go
import (
    "github.com/launchdarkly/go-sdk-common/v3/ldreason"
)

func PrintReason(reason ldreason.EvaluationReason) {
  switch reason.GetKind() {
  case ldreason.EvalReasonOff:
    fmt.Println("it's off")
  case ldreason.EvalReasonFallthrough:
    fmt.Println("fell through")
  case ldreason.EvalReasonTargetMatch:
    fmt.Println("targeted")
  case ldreason.EvalReasonRuleMatch:
    fmt.Printf("matched rule %d/%s\n", r.GetRuleIndex(), r.GetRuleID())
  case ldreason.EvalReasonPrerequisiteFailed:
    fmt.Printf("prereq failed: %s\n", r.GetPrerequisiteKey())
  case ldreason.EvalReasonError:
    fmt.Printf("error: %s\n", r.GetErrorKind())
  }
  // or, if all you want is a simple descriptive string:
  fmt.Println(reason)
}

```

</CSTab>
<CSTab label="Go SDK v5.x">

```go
import (
    "gopkg.in/launchdarkly/go-sdk-common.v2/ldreason"
)

func PrintReason(reason ldreason.EvaluationReason) {
  switch reason.GetKind() {
  case ldreason.EvalReasonOff:
    fmt.Println("it's off")
  case ldreason.EvalReasonFallthrough:
    fmt.Println("fell through")
  case ldreason.EvalReasonTargetMatch:
    fmt.Println("targeted")
  case ldreason.EvalReasonRuleMatch:
    fmt.Printf("matched rule %d/%s\n", r.GetRuleIndex(), r.GetRuleID())
  case ldreason.EvalReasonPrerequisiteFailed:
    fmt.Printf("prereq failed: %s\n", r.GetPrerequisiteKey())
  case ldreason.EvalReasonError:
    fmt.Printf("error: %s\n", r.GetErrorKind())
  }
  // or, if all you want is a simple descriptive string:
  fmt.Println(reason)
}

// The example above is for Go SDK 5.0 and higher. In earlier versions, the
// EvaluationReason could be one of several types, such as EvaluationReasonOff,
// so you would need a switch statement with .(type).
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationReason`](https://pkg.go.dev/github.com/launchdarkly/go-sdk-common/v3@v3.0.0/ldreason#EvaluationReason).

</Details>

### Haskell

<Details summary="Expand Haskell code sample">

The `variationDetail` functions are similar to the `variation` functions, but they also return an explanation of the evaluation that is programmatically inspectable.

Here is an example:

<CodeSample>
<CSTab label="Haskell SDK v4.0">

```haskell
details :: IO (EvaluationDetail Bool)
details = boolVariationDetail client "flag-key-123abc" context False
```

</CSTab>
<CSTab label="Haskell SDK v3.x">

```haskell
details :: IO (EvaluationDetail Bool)
details = boolVariationDetail client "flag-key-123abc" user False
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail`](https://launchdarkly.github.io/haskell-server-sdk/LaunchDarkly-Server-Client.html#t:EvaluationDetail) and [`boolVariationDetail`](https://launchdarkly.github.io/haskell-server-sdk/LaunchDarkly-Server-Client.html#v:boolVariationDetail).
</Details>

### Java

<Details summary="Expand Java code sample">

The `variationDetail` methods, such as [`boolVariationDetail`](https://javadoc.io/doc/com.launchdarkly/launchdarkly-java-server-sdk/latest/com/launchdarkly/sdk/server/LDClient.html#boolVariationDetail(java.lang.String,com.launchdarkly.sdk.LDContext,boolean)), work the same as `variation`, but also provide additional "reason" information about how a flag value was calculated. For example, you can find out if the context was individually targeted for the flag or was matched by one of the flag's rules. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="Java SDK v6.0">

```java
import com.launchdarkly.sdk.*;

EvaluationDetail<Boolean> detail =
  client.boolVariationDetail("flag-key-123abc", context, false);
  // or stringVariationDetail for a string-valued flag, and so on.

boolean value = detail.getValue();
int index = detail.getVariationIndex();       // will be < 0 if evaluation failed
EvaluationReason reason = detail.getReason();
```

</CSTab>
<CSTab label="Java SDK v5.x">

```java
import com.launchdarkly.sdk.*;

EvaluationDetail<Boolean> detail =
  client.boolVariationDetail("flag-key", myUser, false);
  // or stringVariationDetail for a string-valued flag, and so on.

boolean value = detail.getValue();
int index = detail.getVariationIndex();       // will be < 0 if evaluation failed
EvaluationReason reason = detail.getReason();
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail`](https://javadoc.io/doc/com.launchdarkly/launchdarkly-java-server-sdk/latest/com/launchdarkly/sdk/EvaluationDetail.html) and [`boolVariationDetail`](https://javadoc.io/doc/com.launchdarkly/launchdarkly-java-server-sdk/latest/com/launchdarkly/sdk/server/LDClient.html#boolVariationDetail(java.lang.String,com.launchdarkly.sdk.LDContext,boolean)).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="Java">

```java
void printReason(EvaluationReason reason) {
  switch (reason.getKind()) {
    case OFF:
      System.out.println("it's off");
      break;
    case FALLTHROUGH:
      System.out.println("fell through");
      break;
    case TARGET_MATCH:
      System.out.println("targeted");
      break;
    case RULE_MATCH:
      EvaluationReason.RuleMatch rm = (EvaluationReason.RuleMatch)reason;
      System.out.println("matched rule " + rm.getRuleIndex()
        + "/" + rm.getRuleId());
      break;
    case PREREQUISITE_FAILED:
      EvaluationReason.PrerequisiteFailed pf =
        (EvaluationReason.PrerequisiteFailed)reason;
      System.out.println("prereq failed: " + pf.getPrerequisiteKey());
      break;
    case ERROR:
      EvaluationReason.Error e = (EvaluationReason.Error)reason;
      System.out.println("error: " + e.getErrorKind());
  }
  // or, if all you want is a simple descriptive string:
  System.out.println(reason.toString());
}
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationReason`](https://javadoc.io/doc/com.launchdarkly/launchdarkly-java-server-sdk/latest/com/launchdarkly/sdk/EvaluationReason.html).

</Details>

### Lua

<Details summary="Expand Lua code sample">

By using the `*Detail` family of variation calls you can programmatically inspect the reason for a particular evaluation:

<CodeSample>
<CSTab label="Lua">

```lua
local details = client:boolVariationDetail(client, user, "your.feature.key", false);

/* inspect details here */
if details.reason == "FLAG_NOT_FOUND" then
end
```

</CSTab>
</CodeSample>

To learn more about configuration options, read the [API docs](https://launchdarkly.github.io/lua-server-sdk/index.html#Details).
</Details>

### Node.js (server-side)

<Details summary="Expand Node.js (server-side) code sample">

The `variationDetail` method lets you evaluate a feature flag (using the same parameters as you would for `variation`) and receive more information about how the value was calculated.

The variation detail is returned in an object that contains both the result value and a "reason" object which will tell you, for instance, if the context was individually targeted for the flag or was matched by one of the flag's rules. It will also indicate if the flag returned the default value due to an error. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="Node.js SDK v7.0 (JavaScript)">

```js
var detail = client.variationDetail('flag-key-123abc', context, false);

var value = detail.value;
var index = detail.variationIndex;
var reason = detail.reason;
```

</CSTab>
<CSTab label="Node.js SDK v7.0 (TypeScript)">

```ts
client.variationDetail('flag-key-123abc', context, false,
  (detail) => {
    const detailValue = detail.value;
    const detailIndex = detail.variationIndex;
    const detailReason = detail.reason;
});
```

</CSTab>
<CSTab label="Node.js SDK v6.x and earlier (JavaScript)">

```js
var detail = client.variationDetail('flag-key-123abc', user, false);

var value = detail.value;
var index = detail.variationIndex;
var reason = detail.reason;
```

</CSTab>
<CSTab label="Node.js SDK v6.x and earlier (TypeScript)">

```ts
client.variationDetail('flag-key-123abc', user, false,
  (detail) => {
    const detailValue = detail.value;
    const detailIndex = detail.variationIndex;
    const detailReason = detail.reason;
});
```

</CSTab>
</CodeSample>

To learn more, read [`LDEvaluationDetail`](https://launchdarkly.github.io/node-server-sdk/interfaces/_launchdarkly_node_server_sdk_.LDEvaluationDetail.html) and [`variationDetail`](https://launchdarkly.github.io/node-server-sdk/interfaces/_launchdarkly_node_server_sdk_.LDClient.html#variationDetail).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="JavaScript">

```js
function printReason(reason) {
  switch(reason.kind) {
    case "OFF":
      console.log("it's off");
      break;
    case "FALLTHROUGH":
      console.log("fell through");
      break;
    case "TARGET_MATCH":
      console.log("targeted");
      break;
    case "RULE_MATCH":
      console.log("matched rule " + reason.ruleIndex + ", "  + reason.ruleId);
      break;
    case "PREREQUISITE_FAILED":
      console.log("prereq failed: " + reason.prerequisiteKey);
      break;
    case "ERROR":
      console.log("error: " + reason.errorKind);
      break;
  }
}
```

</CSTab>
</CodeSample>

To learn more, read [`LDEvaluationReason`](https://launchdarkly.github.io/node-server-sdk/interfaces/_launchdarkly_node_server_sdk_.LDEvaluationReason.html).

</Details>

### Node.js (Cloudflare)

This SDK uses the same code as the [Node.js server-side SDK](#nodejs-server-side).

To learn more, read [`variationDetail`](https://launchdarkly.github.io/cloudflare-edge-sdk/interfaces/LDClient.html#variationDetail).

### PHP

<Details summary="Expand PHP code sample">

The `variationDetail` method lets you evaluate a feature flag (using the same parameters as you would for `variation`) and receive more information about how the value was calculated.

The variation detail is returned in an object that contains both the result value and a "reason" object which will tell you, for example, if the context was individually targeted for the flag or was matched by one of the flag's rules. It will also indicate if the flag returned the default value due to an error. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="PHP SDK v5.0">

```php

$detail = $client->variationDetail("flag-key-123abc", $myContext, false);

$value = $detail->getValue();
$index = $detail->getVariationIndex();
$reason = $detail->getReason();
```

</CSTab>
<CSTab label="PHP SDK v4.x">

```php

$detail = $client->variationDetail("flag-key", $myUser, false);

$value = $detail->getValue();
$index = $detail->getVariationIndex();
$reason = $detail->getReason();
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail`](https://launchdarkly.github.io/php-server-sdk/classes/LaunchDarkly-EvaluationDetail.html) and [`variationDetail`](https://launchdarkly.github.io/php-server-sdk/classes/LaunchDarkly-LDClient.html#method_variationDetail).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="PHP SDK v5.0 and earlier">

```php
function printReason($reason) {
  switch ($reason->getKind()) {
    case EvaluationReason::OFF:
      echo("it's off");
      break;
    case EvaluationReason::FALLTHROUGH:
      echo("fell through");
      break;
    case EvaluationReason::TARGET_MATCH:
      echo("targeted");
      break;
    case EvaluationReason::RULE_MATCH:
      echo("matched rule " . $reason->getRuleIndex() .
        "/" . $reason->getRuleId());
      break;
    case EvaluationReason::PREREQUISITE_FAILED:
      echo("prereq failed: " . $reason->getPrerequisiteKey());
      break;
    case EvaluationReason::ERROR:
      echo("error: " . $reason->getErrorKind());
      break;
  }
  // or, if all you want is a simple descriptive string:
  echo $reason;
}
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationReason`](https://launchdarkly.github.io/php-server-sdk/classes/LaunchDarkly-EvaluationReason.html).

</Details>

### Python

<Details summary="Expand Python code sample">

The `variation_detail` method lets you evaluate a feature flag with the same parameters as you would for `variation`. You can use this method to receive more information about how the value was calculated.

The variation detail is returned in an object that contains both the result value and a "reason" object which will tell you, for instance, if the context was individually targeted for the flag or was matched by one of the flag's rules. It will also indicate if the flag returned the default value due to an error. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="Python SDK v8.0">

```python
detail = client.variation_detail("flag-key-123abc", my_context, False)
value = detail.value
index = detail.variation_index
reason = detail.reason
```

</CSTab>
<CSTab label="Python SDK v7.x">

```python
detail = client.variation_detail("flag-key-123abc", my_user, False)
value = detail.value
index = detail.variation_index
reason = detail.reason
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail`](https://launchdarkly-python-sdk.readthedocs.io/en/latest/api-main.html#ldclient.evaluation.EvaluationDetail) and [`variation_detail`](https://launchdarkly-python-sdk.readthedocs.io/en/latest/api-main.html#ldclient.client.LDClient.variation_detail).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="Python">

```python
def print_reason(reason):
  kind = reason["kind"]
  if kind == "OFF":
    print "it's off"
  elif kind == "FALLTHROUGH":
    print "fell through"
  elif kind == "TARGET_MATCH":
    print "targeted"
  elif kind == "RULE_MATCH":
    print "matched rule %d/%s" % (reason["ruleIndex"], reason["ruleId"])
  elif kind == "PREREQUISITE_FAILED":
    print "prereq failed: %s" % reason["prerequisiteKey"]
  elif kind == "ERROR":
    print "error: %s" % reason["errorKind"]
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail.reason`](https://launchdarkly-python-sdk.readthedocs.io/en/latest/api-main.html#ldclient.evaluation.EvaluationDetail.reason).

</Details>

### Ruby

<Details summary="Expand Ruby code sample">

The `variation_detail` method lets you evaluate a feature flag (using the same parameters as you would for `variation`) and receive more information about how the value was calculated.

The variation detail is returned in an object that contains both the result value and a "reason" object which will tell you, for instance, if the context was individually targeted for the flag or was matched by one of the flag's rules. It will also indicate if the flag returned the default value due to an error. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="Ruby SDK v7.0">

```ruby
detail = client.variation_detail("flag-key", my_context, false)
value = detail.value
index = detail.variation_index
reason = detail.reason
```

</CSTab>
<CSTab label="Ruby SDK v6.x">

```ruby
detail = client.variation_detail("flag-key", my_user, false)
value = detail.value
index = detail.variation_index
reason = detail.reason
```

</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail`](https://www.rubydoc.info/gems/launchdarkly-server-sdk/LaunchDarkly/EvaluationDetail) and [`variation_detail`](https://www.rubydoc.info/gems/launchdarkly-server-sdk/LaunchDarkly/LDClient#variation_detail-instance_method).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="Ruby">

```ruby
def print_reason(reason)
  case reason[:kind]
  when "OFF"
    puts "it's off"
  when "FALLTHROUGH"
    puts "fell through"
  when "TARGET_MATCH"
    puts "targeted"
  when "RULE_MATCH"
    puts "matched rule #{reason[:ruleIndex]}/#{reason[:ruleId]}"
  when "PREREQUISITE_FAILED"
    puts "prereq failed: #{reason[:prerequisiteKey]}"
  when "ERROR"
    puts "error: #{reason[:errorKind]}"
  end
end
```
</CSTab>
</CodeSample>

To learn more, read [`EvaluationDetail.reason`](https://www.rubydoc.info/gems/launchdarkly-server-sdk/LaunchDarkly/EvaluationDetail#reason-instance_method).

</Details>

### Rust

<Details summary="Expand Rust code sample">

The `variation_detail` methods (for example, [`bool_variation_detail`](https://docs.rs/launchdarkly-server-sdk/latest/launchdarkly_server_sdk/struct.Client.html#method.bool_variation_detail)) let you evaluate a feature flag, using the same parameters as you would for `variation`, and receive more information about how the flag value was calculated. For example, you can find out if the context was individually targeted for the flag or was matched by one of the flag's rules. You can examine the "reason" data programmatically, or, if you capture detailed analytics events for flags, view it with Data Export.

Here is an example:

<CodeSample>
<CSTab label="Rust SDK v1">

```rust
let detail = client.bool_variation_detail(&context, "flag-key", false);

let value = detail.value;
let index = detail.variation_index;
let reason = detail.reason;
```
</CSTab>
<CSTab label="Rust SDK beta">

```rust
let detail = client.bool_variation_detail(&user, "flag-key", false);

let value = detail.value;
let index = detail.variation_index;
let reason = detail.reason;
```
</CSTab>
</CodeSample>

To learn more, read [`variation_detail`](https://docs.rs/launchdarkly-server-sdk/latest/launchdarkly_server_sdk/struct.Client.html#method.variation_detail) and [`bool_variation_detail`](https://docs.rs/launchdarkly-server-sdk/latest/launchdarkly_server_sdk/struct.Client.html#method.bool_variation_detail).

Here is an example of how to access the details of a reason object:

<CodeSample>
<CSTab label="Rust SDK v1">

```rust
fn print_reason(reason: Reason) {
    match reason {
        Reason::Off => println!("it's off"),
        Reason::Fallthrough { .. } => println!("fell through"),
        Reason::TargetMatch => println!("targeted"),
        Reason::RuleMatch {
            rule_index,
            rule_id,
            ..
        } => println!("matched rule {}/{}", rule_index, rule_id),
        Reason::PrerequisiteFailed { prerequisite_key } => {
            println!("prereq failed: {}", prerequisite_key)
        }
        Reason::Error { error } => println!("error: {:?}", error),
    };
}
```

</CSTab>
</CodeSample>

To learn more, read [`Reason`](https://docs.rs/launchdarkly-server-sdk/latest/launchdarkly_server_sdk/enum.Reason.html).

</Details>
